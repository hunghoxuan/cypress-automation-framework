DECLARE
	v_record_date VARCHAR2(8);
BEGIN
	SELECT POSTING_DATE
	INTO v_record_date
	FROM SYS_POSTING_DATE
	WHERE INSTITUTION_NUMBER = 'var_institution_number'
	AND STATION_NUMBER = 'var_station_number';
DELETE COS_BPR_DATA WHERE institution_number = 'var_institution_number' AND retrieval_reference = '00ISATC02001';
DELETE COS_BPR_DATA WHERE institution_number = 'var_institution_number' AND BPR_LOG_ID = '111230411114200001';
DELETE COS_BPR_LOG WHERE BPR_LOG_ID = '111230411114200001';
DELETE COS_BPR_DATA WHERE institution_number = 'var_institution_number' AND BPR_LOG_ID = '111230411114200002';
DELETE COS_BPR_LOG WHERE BPR_LOG_ID = '111230411114200002';
DELETE COS_BPR_DATA WHERE institution_number = 'var_institution_number' AND BPR_LOG_ID = '111230411114200003';
DELETE COS_BPR_LOG WHERE BPR_LOG_ID = '111230411114200003';
DELETE COS_BPR_DATA WHERE institution_number = 'var_institution_number' AND BPR_LOG_ID = '111230411114200004';
DELETE COS_BPR_LOG WHERE BPR_LOG_ID = '111230411114200004';
INSERT INTO COS_BPR_DATA (BPR_LOG_ID, RECORD_DATE, BW3_RECORD_DATE, BW3_RECORD_TIME, BPR_TYPE_NAME, TRANSACTION_ID_OLD, TRANSACTION_LINK_ID_OLD, INSTITUTION_NUMBER, MESSAGE_TYPE, TRANSACTION_DATE, TRANSMISSION_DATE, RETRIEVAL_REFERENCE, STAN, ACQUIRING_INST_ID, FORWARDING_INST_ID, TRANSACTION_STATUS, NETWORK_ID, BATCH_ID, CARD_NUMBER, EXPIRY_DATE, PROCESS_CODE, MCC_CODE, TRACK_2_DATA, TERMINAL_ID, RESPONSE_CODE, RESPONSE_DATA, AUTH_CODE, BILLING_CURRENCY, BILLING_AMOUNT, SETTLEMENT_CURRENCY, SETTLEMENT_AMOUNT, REQUESTED_CURRENCY, REQUESTED_AMOUNT, SETTLEMENT_RATE, SETTLEMENT_DATE, SETTLEMENT_RATE_DATE, SETTLEMENT_FEE, PROCESSING_FEE, POS_ENTRY, POS_DATA, INF_DATA, ORIGINAL_DATA, REPLACEMENT_AMOUNT, REASON_CODE, MERCHANT_ID, MERCHANT_NAME, ECOM_SECURITY_LEVEL, CVC_INVALID, LOCKING_COUNTER, CASHBACK_AMOUNT, EXTERNAL_REF, TRANSACTION_ID, TRANSACTION_LINK_ID, HOSTNAME)
	VALUES (111230411114200001, to_timestamp(to_char(to_date(v_record_date, 'YYYYMMDD')-1, 'yyyymmdd')||'114248','YYMMDDHH24MISS'), to_char(to_date(v_record_date,'YYYYMMDD')-1,'yyyymmdd'), '11:42:48', 'BPR_HST_ISS', 111230411114200000, 111230411114200000, 'var_institution_number', '0200', to_date(to_char(to_date(v_record_date, 'YYYYMMDD'),'yyyymmdd')||'114248', 'YYMMDDHH24MISS') - 1, to_date(to_char(to_date(v_record_date, 'YYYYMMDD'),'yyyymmdd')||'114248', 'YYMMDDHH24MISS') - 1, '00ISATC02001', '000000', '00000000111', '00000000111', '999', null, null, '8888013111234566', '3012', '000000', '5999', null, '10000150', '', null, '', null, null, '', '', '978', '110.0', '', null, '', null, null, '000', '00', 'DE25:00/BIN_CNTRY:DE/DE63.AD:Y/DE63.AR:N/DE63.CA:N/DE63.GS:N/DE63.IA:N/DE63.IT:N/DE63.LG:N/DE63.PY:Y/DE52:N/DE48.07:009/AUTH_IND:T/DE60:000000000500/DE62.2:003101SATC02001/DE104.2:*/DE44.1: /DE44.2: /DE104_5F.08: /', null, null, null, '000000000000337', 'MERCHANT NAMEMERCHANT CITY            DU', null, null, null, '', null, '00000111-ISATC02001-1114200000', '00000111-ISATC02001-1114200000', 'GENERATOR');
INSERT INTO COS_BPR_LOG (BPR_LOG_ID, RECORD_DATE, MESSAGE_DATA, LOCKING_COUNTER, MSG_DATA_JSON, TRANSACTION_LINK_ID)
	VALUES (111230411114200001, to_timestamp(to_char(to_date(v_record_date,'YYYYMMDD')-1,'yyyymmdd')||'114248','YYYYMMDDHH24:MI:SS.FF'), null, null, utl_raw.cast_to_raw('{"hdr": {"rte": 4, "key": "BPR_HST_ISS0000000011100000000111041100ISATC02001", "id": "00000111-00ISATC02001-1114200000", "trn_id": "00000111-00ISATC02001-1114200000", "lnk_id": "00000111-00ISATC02001-1114200000", "dst": "BPR_HST_ISS/tran_generator/1", "src": "ADT_HST_ISS/tran_generator/1", "sts": 0, "type": 6, "ttl": 2, "agt": "", "size": 305, "flds": 164, "max_time": 10, "usr_flgs": 0, "tmo": 0, "dt": {"s": 1608688405, "us": 736910}, "tx_dt": {"s": 1608688405, "us": 736910}}, "msg": {"ecom": {}, "emv": {}, "bw": {"dst": "003", "inst": "00000111"}, "hst": {}, "to_idx": "00", "fr_idx": "00", "aq_id": "83844", "fw_id": "83844", "type": "00", "mti": "0200", "date": "0411", "rrn": "00ISATC02001", "tx_dt": "1223015324", "time": "145324", "stan": "000000", "tpdu_header": "02000000303030315902", "sig": "GEN00STD00VIP00", "aq_ctry": "DE", "fin": {"ccy": "978", "amt": "000000001100"}, "merc": {"name": "MERCHANT NAMEDE", "ctry": "DE", "mcc": "5999", "id": "000000000000337", "city": "         ", "prog_dat": "           "}, "net": {}, "orig": {}, "bat": {}}}'), '00000111-ISATC02001-1114200000');
INSERT INTO COS_BPR_DATA (BPR_LOG_ID, RECORD_DATE, BW3_RECORD_DATE, BW3_RECORD_TIME, BPR_TYPE_NAME, TRANSACTION_ID_OLD, TRANSACTION_LINK_ID_OLD, INSTITUTION_NUMBER, MESSAGE_TYPE, TRANSACTION_DATE, TRANSMISSION_DATE, RETRIEVAL_REFERENCE, STAN, ACQUIRING_INST_ID, FORWARDING_INST_ID, TRANSACTION_STATUS, NETWORK_ID, BATCH_ID, CARD_NUMBER, EXPIRY_DATE, PROCESS_CODE, MCC_CODE, TRACK_2_DATA, TERMINAL_ID, RESPONSE_CODE, RESPONSE_DATA, AUTH_CODE, BILLING_CURRENCY, BILLING_AMOUNT, SETTLEMENT_CURRENCY, SETTLEMENT_AMOUNT, REQUESTED_CURRENCY, REQUESTED_AMOUNT, SETTLEMENT_RATE, SETTLEMENT_DATE, SETTLEMENT_RATE_DATE, SETTLEMENT_FEE, PROCESSING_FEE, POS_ENTRY, POS_DATA, INF_DATA, ORIGINAL_DATA, REPLACEMENT_AMOUNT, REASON_CODE, MERCHANT_ID, MERCHANT_NAME, ECOM_SECURITY_LEVEL, CVC_INVALID, LOCKING_COUNTER, CASHBACK_AMOUNT, EXTERNAL_REF, TRANSACTION_ID, TRANSACTION_LINK_ID, HOSTNAME)
	VALUES (111230411114200002, to_timestamp(to_char(to_date(v_record_date, 'YYYYMMDD')-1, 'yyyymmdd')||'114248','YYMMDDHH24MISS'), to_char(to_date(v_record_date,'YYYYMMDD')-1,'yyyymmdd'), '11:42:48', 'BPR_HST_ISS', 111230411114200000, 111230411114200000, 'var_institution_number', '0210', to_date(to_char(to_date(v_record_date, 'YYYYMMDD'),'yyyymmdd')||'114248', 'YYMMDDHH24MISS') - 1, to_date(to_char(to_date(v_record_date, 'YYYYMMDD'),'yyyymmdd')||'114248', 'YYMMDDHH24MISS') - 1, '00ISATC02001', '000000', '00000000111', '00000000111', '999', null, null, '8888013111234566', '3012', '000000', '5999', null, '10000150', '00', null, '660309', null, null, '', '', '978', '110.0', '', null, '', null, null, '000', '00', 'DE25:00/BIN_CNTRY:DE/DE63.AD:Y/DE63.AR:N/DE63.CA:N/DE63.GS:N/DE63.IA:N/DE63.IT:N/DE63.LG:N/DE63.PY:Y/DE52:N/DE48.07:009/AUTH_IND:T/DE60:000000000500/DE62.2:003101SATC02001/DE104.2:*/DE44.1: /DE44.2: /DE104_5F.08: /', null, null, null, '000000000000337', 'MERCHANT NAMEMERCHANT CITY            DU', null, null, null, '', null, '00000111-ISATC02001-1114200000', '00000111-ISATC02001-1114200000', 'GENERATOR');
INSERT INTO COS_BPR_LOG (BPR_LOG_ID, RECORD_DATE, MESSAGE_DATA, LOCKING_COUNTER, MSG_DATA_JSON, TRANSACTION_LINK_ID)
	VALUES (111230411114200002, to_timestamp(to_char(to_date(v_record_date,'YYYYMMDD')-1,'yyyymmdd')||'114248','YYYYMMDDHH24:MI:SS.FF'), null, null, utl_raw.cast_to_raw('{"hdr": {"rte": 4, "key": "BPR_HST_ISS0000000011100000000111041100ISATC02001", "id": "00000111-00ISATC02001-1114200000", "trn_id": "00000111-00ISATC02001-1114200000", "lnk_id": "00000111-00ISATC02001-1114200000", "dst": "BPR_HST_ISS/tran_generator/1", "src": "ADT_HST_ISS/tran_generator/1", "sts": 0, "type": 6, "ttl": 2, "agt": "", "size": 305, "flds": 164, "max_time": 10, "usr_flgs": 0, "tmo": 0, "dt": {"s": 1608688405, "us": 736910}, "tx_dt": {"s": 1608688405, "us": 736910}}, "msg": {"ecom": {}, "emv": {}, "bw": {"dst": "003", "inst": "00000111"}, "hst": {}, "auth_cd": "200000", "rc": "00", "to_idx": "00", "fr_idx": "00", "aq_id": "83844", "fw_id": "83844", "type": "00", "mti": "0210", "date": "0411", "rrn": "00ISATC02001", "tx_dt": "1223015324", "time": "145324", "stan": "000000", "tpdu_header": "02000000303030315902", "sig": "GEN00STD00VIP00", "aq_ctry": "DE", "fin": {"ccy": "978", "amt": "000000001100"}, "merc": {"name": "MERCHANT NAMEDE", "ctry": "DE", "mcc": "5999", "id": "000000000000337", "city": "         ", "prog_dat": "           "}, "net": {}, "orig": {}, "bat": {}}}'), '00000111-ISATC02001-1114200000');
INSERT INTO COS_BPR_DATA (BPR_LOG_ID, RECORD_DATE, BW3_RECORD_DATE, BW3_RECORD_TIME, BPR_TYPE_NAME, TRANSACTION_ID_OLD, TRANSACTION_LINK_ID_OLD, INSTITUTION_NUMBER, MESSAGE_TYPE, TRANSACTION_DATE, TRANSMISSION_DATE, RETRIEVAL_REFERENCE, STAN, ACQUIRING_INST_ID, FORWARDING_INST_ID, TRANSACTION_STATUS, NETWORK_ID, BATCH_ID, CARD_NUMBER, EXPIRY_DATE, PROCESS_CODE, MCC_CODE, TRACK_2_DATA, TERMINAL_ID, RESPONSE_CODE, RESPONSE_DATA, AUTH_CODE, BILLING_CURRENCY, BILLING_AMOUNT, SETTLEMENT_CURRENCY, SETTLEMENT_AMOUNT, REQUESTED_CURRENCY, REQUESTED_AMOUNT, SETTLEMENT_RATE, SETTLEMENT_DATE, SETTLEMENT_RATE_DATE, SETTLEMENT_FEE, PROCESSING_FEE, POS_ENTRY, POS_DATA, INF_DATA, ORIGINAL_DATA, REPLACEMENT_AMOUNT, REASON_CODE, MERCHANT_ID, MERCHANT_NAME, ECOM_SECURITY_LEVEL, CVC_INVALID, LOCKING_COUNTER, CASHBACK_AMOUNT, EXTERNAL_REF, TRANSACTION_ID, TRANSACTION_LINK_ID, HOSTNAME)
	VALUES (111230411114200003, to_timestamp(to_char(to_date(v_record_date, 'YYYYMMDD')-1, 'yyyymmdd')||'114248','YYMMDDHH24MISS'), to_char(to_date(v_record_date,'YYYYMMDD')-1,'yyyymmdd'), '11:42:48', 'BPR_VISA_FSDE_ACQ', 111230411114200000, 111230411114200000, 'var_institution_number', '0100', to_date(to_char(to_date(v_record_date, 'YYYYMMDD'),'yyyymmdd')||'114248', 'YYMMDDHH24MISS') - 1, to_date(to_char(to_date(v_record_date, 'YYYYMMDD'),'yyyymmdd')||'114248', 'YYMMDDHH24MISS') - 1, '00ISATC02001', '000000', '00000483844', '00000483844', '999', null, null, '8888013111234566', '3012', '000000', '5999', null, '10000150', '', null, '', null, null, '', '', '978', '110.0', '', null, '', null, null, '000', '000000000500', 'DE25:00/BIN_CNTRY:DE/DE63.AD:Y/DE63.AR:N/DE63.CA:N/DE63.GS:N/DE63.IA:N/DE63.IT:N/DE63.LG:N/DE63.PY:Y/DE52:N/DE48.07:009/AUTH_IND:T/DE60:000000000500/DE62.2:003101SATC02001/DE104.2:*/DE44.1: /DE44.2: /DE104_5F.08: /', null, null, null, '000000000000337', 'MERCHANT NAMEMERCHANT CITY            DU', null, null, null, '', null, '00000111-ISATC02001-1114200000', '00000111-ISATC02001-1114200000', 'GENERATOR');
INSERT INTO COS_BPR_LOG (BPR_LOG_ID, RECORD_DATE, MESSAGE_DATA, LOCKING_COUNTER, MSG_DATA_JSON, TRANSACTION_LINK_ID)
	VALUES (111230411114200003, to_timestamp(to_char(to_date(v_record_date,'YYYYMMDD')-1,'yyyymmdd')||'114248','YYYYMMDDHH24:MI:SS.FF'), null, null, utl_raw.cast_to_raw('{"hdr": {"rte": 4, "key": "BPR_VISA_FSDE_ACQ0000011100000000111041100ISATC02001", "id": "00000111-00ISATC02001-1114200000", "trn_id": "00000111-00ISATC02001-1114200000", "lnk_id": "00000111-00ISATC02001-1114200000", "dst": "BPR_VISA_FSDE_ACQ/tran_generator/1", "src": "ADT_VISA_FSDE_ACQ/tran_generator/1", "sts": 0, "type": 6, "ttl": 2, "agt": "", "size": 305, "flds": 164, "max_time": 10, "usr_flgs": 0, "tmo": 0, "dt": {"s": 1608688405, "us": 736910}, "tx_dt": {"s": 1608688405, "us": 736910}}, "msg": {"ecom": {}, "emv": {}, "bw": {"dst": "003", "inst": "00000111"}, "hst": {"external_ref": "12345678901234567890                ", "bai": "*", "add": {"py": {"rec_fname": "BUNITRCPTFIRST ", "rec_lname": "BUNITRCPTLAST  ", "snd_fname": "BUNITSENDERFR$", "snd_lname": "", "snd_act": "0123456789012345678901234567890123", "snd_ref": "0123456789ABCDEF", "snd_id": "BUNITSENDERID           ", "snd_strt": "BUNITADDRESS                       ", "snd_city": "Visa Direct ", "snd_state": "BU", "snd_ctry": "840", "snd_pc": "BUPOSTCODE", "fnd_src": "03"}}}, "to_idx": "00", "fr_idx": "00", "aq_id": "83844", "fw_id": "83844", "type": "00", "mti": "0200", "date": "0411", "rrn": "00ISATC02001", "tx_dt": "1223015324", "time": "145324", "stan": "000000", "tpdu_header": "02000000303030315902", "sig": "GEN00STD00VIP00", "aq_ctry": "DE", "fin": {"ccy": "978", "amt": "000000001100"}, "merc": {"name": "MERCHANT NAMEDE", "ctry": "DE", "mcc": "5999", "id": "000000000000337", "city": "         ", "prog_dat": "           "}, "net": {}, "orig": {}, "bat": {}, "vip": {"de44": {"sf1": "5", "sf3": " ", "sf4": " ", "sf6": "  ", "sf7": " ", "sf8": " ", "sf9": " "}, "de104": {"sf57": "*"}, "hdr": {"fld1": "01", "fld2": "02", "fld3": "0079", "fld4": "123456", "fld5": "000000", "fld6": "00", "fld7": "0000", "fld8": "000000", "fld9": "00", "fld10": "000000", "fld11": "00"}}}}'), '00000111-ISATC02001-1114200000');
INSERT INTO COS_BPR_DATA (BPR_LOG_ID, RECORD_DATE, BW3_RECORD_DATE, BW3_RECORD_TIME, BPR_TYPE_NAME, TRANSACTION_ID_OLD, TRANSACTION_LINK_ID_OLD, INSTITUTION_NUMBER, MESSAGE_TYPE, TRANSACTION_DATE, TRANSMISSION_DATE, RETRIEVAL_REFERENCE, STAN, ACQUIRING_INST_ID, FORWARDING_INST_ID, TRANSACTION_STATUS, NETWORK_ID, BATCH_ID, CARD_NUMBER, EXPIRY_DATE, PROCESS_CODE, MCC_CODE, TRACK_2_DATA, TERMINAL_ID, RESPONSE_CODE, RESPONSE_DATA, AUTH_CODE, BILLING_CURRENCY, BILLING_AMOUNT, SETTLEMENT_CURRENCY, SETTLEMENT_AMOUNT, REQUESTED_CURRENCY, REQUESTED_AMOUNT, SETTLEMENT_RATE, SETTLEMENT_DATE, SETTLEMENT_RATE_DATE, SETTLEMENT_FEE, PROCESSING_FEE, POS_ENTRY, POS_DATA, INF_DATA, ORIGINAL_DATA, REPLACEMENT_AMOUNT, REASON_CODE, MERCHANT_ID, MERCHANT_NAME, ECOM_SECURITY_LEVEL, CVC_INVALID, LOCKING_COUNTER, CASHBACK_AMOUNT, EXTERNAL_REF, TRANSACTION_ID, TRANSACTION_LINK_ID, HOSTNAME)
	VALUES (111230411114200004, to_timestamp(to_char(to_date(v_record_date, 'YYYYMMDD')-1, 'yyyymmdd')||'114248','YYMMDDHH24MISS'), to_char(to_date(v_record_date,'YYYYMMDD')-1,'yyyymmdd'), '11:42:48', 'BPR_VISA_FSDE_ACQ', 111230411114200000, 111230411114200000, 'var_institution_number', '0110', to_date(to_char(to_date(v_record_date, 'YYYYMMDD'),'yyyymmdd')||'114248', 'YYMMDDHH24MISS') - 1, to_date(to_char(to_date(v_record_date, 'YYYYMMDD'),'yyyymmdd')||'114248', 'YYMMDDHH24MISS') - 1, '00ISATC02001', '000000', '00000483844', '00000483844', '999', null, null, '8888013111234566', '3012', '000000', '5999', null, '10000150', '00', null, '660309', null, null, '', '', '978', '110.0', '', null, '', null, null, '000', '000000000500', 'DE25:00/BIN_CNTRY:DE/DE63.AD:Y/DE63.AR:N/DE63.CA:N/DE63.GS:N/DE63.IA:N/DE63.IT:N/DE63.LG:N/DE63.PY:Y/DE52:N/DE48.07:009/AUTH_IND:T/DE60:000000000500/DE62.2:003101SATC02001/DE104.2:*/DE44.1: /DE44.2: /DE104_5F.08: /', null, null, null, '000000000000337', 'MERCHANT NAMEMERCHANT CITY            DU', null, null, null, '', null, '00000111-ISATC02001-1114200000', '00000111-ISATC02001-1114200000', 'GENERATOR');
INSERT INTO COS_BPR_LOG (BPR_LOG_ID, RECORD_DATE, MESSAGE_DATA, LOCKING_COUNTER, MSG_DATA_JSON, TRANSACTION_LINK_ID)
	VALUES (111230411114200004, to_timestamp(to_char(to_date(v_record_date,'YYYYMMDD')-1,'yyyymmdd')||'114248','YYYYMMDDHH24:MI:SS.FF'), null, null, utl_raw.cast_to_raw('{"hdr": {"rte": 4, "key": "BPR_VISA_FSDE_ACQ0000011100000000111041100ISATC02001", "id": "00000111-00ISATC02001-1114200000", "trn_id": "00000111-00ISATC02001-1114200000", "lnk_id": "00000111-00ISATC02001-1114200000", "dst": "BPR_VISA_FSDE_ACQ/tran_generator/1", "src": "ADT_VISA_FSDE_ACQ/tran_generator/1", "sts": 0, "type": 6, "ttl": 2, "agt": "", "size": 305, "flds": 164, "max_time": 10, "usr_flgs": 0, "tmo": 0, "dt": {"s": 1608688405, "us": 736910}, "tx_dt": {"s": 1608688405, "us": 736910}}, "msg": {"ecom": {}, "emv": {}, "bw": {"dst": "003", "inst": "00000111"}, "hst": {"external_ref": "12345678901234567890                ", "bai": "*", "add": {"py": {"rec_fname": "BUNITRCPTFIRST ", "rec_lname": "BUNITRCPTLAST  ", "snd_fname": "BUNITSENDERFR$", "snd_lname": "", "snd_act": "0123456789012345678901234567890123", "snd_ref": "0123456789ABCDEF", "snd_id": "BUNITSENDERID           ", "snd_strt": "BUNITADDRESS                       ", "snd_city": "Visa Direct ", "snd_state": "BU", "snd_ctry": "840", "snd_pc": "BUPOSTCODE", "fnd_src": "03"}}}, "auth_cd": "200000", "rc": "00", "to_idx": "00", "fr_idx": "00", "aq_id": "83844", "fw_id": "83844", "type": "00", "mti": "0210", "date": "0411", "rrn": "00ISATC02001", "tx_dt": "1223015324", "time": "145324", "stan": "000000", "tpdu_header": "02000000303030315902", "sig": "GEN00STD00VIP00", "aq_ctry": "DE", "fin": {"ccy": "978", "amt": "000000001100"}, "merc": {"name": "MERCHANT NAMEDE", "ctry": "DE", "mcc": "5999", "id": "000000000000337", "city": "         ", "prog_dat": "           "}, "net": {}, "orig": {}, "bat": {}, "vip": {"de44": {"sf1": "5", "sf3": " ", "sf4": " ", "sf6": "  ", "sf7": " ", "sf8": " ", "sf9": " "}, "de104": {"sf57": "*"}, "hdr": {"fld1": "01", "fld2": "02", "fld3": "0079", "fld4": "123456", "fld5": "000000", "fld6": "00", "fld7": "0000", "fld8": "000000", "fld9": "00", "fld10": "000000", "fld11": "00"}}}}'), '00000111-ISATC02001-1114200000');
COMMIT;
END;
/